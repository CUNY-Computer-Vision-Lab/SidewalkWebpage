@import models.user.User
@import models.user.WebpageActivityTable
@import models.user.UserCurrentRegionTable
@import models.daos._
@import models.audit._
@import models.label._
@import models.mission.MissionTable
@import models.street.StreetEdgeTable
@import models.audit.AuditTaskCommentTable
@import java.util.UUID
@import play.api.libs.json.Json

@(title: String, user: Option[User] = None)
@main(title) {
    @navbar(user)
    <style>
            .no-js #loader { display: none;  }
            .js #loader { display: block; position: absolute; left: 100px; top: 0; }
            .loader {
                position: fixed;
                left: 0px;
                top: 0px;
                width: 100%;
                height: 100%;
                z-index: 9999;
                background: url('/assets/images/loader.gif') center no-repeat #fff ;
            }
    </style>

    <!-- Added JS function to handle toggling Generated Routes layer -->
    <script>
    $(document).ready(function(){
      $('#generated_street').click(function(){
        var check = document.getElementById("generated_street").checked;
        if (check == true){
          $("path[stroke-opacity='0.75']").show();
        }
        if (check == false){
          $("path[stroke-opacity='0.75']").hide();
        }
      });
    });
    </script>
    <div class="loader"></div>
    <div class="container-fluid">
      <div id="row">
        <div class="col-lg-12">
            <div id="map-holder">
                <div id="admin-map"></div>
                <div id="map-label-legend">
                    <table class="table filter">
                        <tr>
                            <td colspan="4" align="center" style="font-weight:bold">Legend</td>
                        </tr>
                        <tr>
                            <td id="map-legend-audited-street"></td>
                            <td>Generated Route</td>
                            <td><input type="checkbox" value="displaylabel" id="generated_street" checked="true"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
            <div class="col-lg-2">
                <ul class="nav nav-pills nav-stacked">
                    <li><a href="#tabs-2" data-toggle="pill" id="visualization" align="center">Display Routes</a></li>
                </ul>
            </div>
            <div class="col-lg-12">
                <div class="tab-content hidden">
                    <div id="tabs-2" class="tab-pane">
                      <div id="admin-choropleth"></div>
                    </div>
              </div>
          </div>

      </div>
  </div>

    <link href='@routes.Assets.at("stylesheets/c3.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/admin.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/bootstrap.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/dataTables.bootstrap.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/ekko-lightbox.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/ekko-lightbox.min.css")' rel="stylesheet"/>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">

    <script type="text/javascript" src='@routes.Assets.at("javascripts/routeviz.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/moment.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/d3.v3.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/c3.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/turf.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/jquery.dataTables.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/dataTables.bootstrap.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/Utilities.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/UtilitiesSidewalk.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/UtilitiesColor.js")'></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.0-beta.33/vega.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.0.0-beta.4/vega-lite.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-embed/3.0.0-beta.17/vega-embed.js"></script>

    <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />

    <script>
            var labelArr = new Array(1, 2, 3, 4, 5, "All");
            var sliderToLabelMap = {};
            sliderToLabelMap["curb-ramp-slider"] = "#curb-ramp-severity-label";
            sliderToLabelMap["missing-curb-ramp-slider"] = "#missing-curb-ramp-severity-label";
            sliderToLabelMap["obstacle-slider"] = "#obstacle-severity-label";
            sliderToLabelMap["surface-problem-slider"] = "#surface-problem-severity-label";
            sliderToLabelMap["occlusion-slider"]  = "#occlusion-severity-label";
            sliderToLabelMap["no-sidewalk-slider"] = "#no-sidewalk-severity-label";
            sliderToLabelMap["other-slider"] = "#other-severity-label";

            $( "*[id*='slider']" ).each(function() {
                $(this).slider({
                    min : 0,
                    max : 5,
                    step: 1,
                    value: 5,
                    slide: function(event, ui) {
                        $(sliderToLabelMap[this.id]).text(labelArr[ui.value]);
                    },
                    change: function(event,ui) {
                        if (this.id == "curb-ramp-slider") {
                            admin.toggleLayers('CurbRamp', 'curbramp', '#curb-ramp-slider');
                        } else if (this.id == "missing-curb-ramp-slider") {
                            admin.toggleLayers('NoCurbRamp', 'missingcurbramp', '#missing-curb-ramp-slider');
                        } else if (this.id == "obstacle-slider") {
                            admin.toggleLayers('Obstacle', 'obstacle', '#obstacle-slider')
                        } else if (this.id == 'surface-problem-slider') {
                            admin.toggleLayers('SurfaceProblem', 'surfaceprob', '#surface-problem-slider');
                        } else if (this.id == 'occlusion-slider') {
                            admin.toggleLayers('Occlusion', 'occlusion', '#occlusion-slider');
                        } else if (this.id == 'no-sidewalk-slider') {
                            admin.toggleLayers('NoSidewalk', 'nosidewalk', '#no-sidewalk-slider');
                        } else if (this.id == 'other-slider') {
                            admin.toggleLayers('Other', 'other', '#other-slider');
                        }
                    }
                });
            });

    </script>
    <script>
            $(document).ready(function () {

                var difficultRegionIds = @Json.toJson(UserCurrentRegionTable.difficultRegionIds);
                window.admin = RouteViz(_, $, c3, turf, difficultRegionIds);

            });
            $(window).load(function() {
                $(".loader").fadeOut("slow");
            })
    </script>
}
