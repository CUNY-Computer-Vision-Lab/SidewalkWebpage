@import models.user.User
@import models.user.WebpageActivityTable
@import models.daos._
@import models.audit._
@import models.label._
@import models.mission.MissionTable
@import models.street.StreetEdgeTable
@import models.audit.AuditTaskCommentTable
@import java.util.UUID

@(title: String, user: Option[User] = None)

@main(title) {
    @navbar(user)
    <div class="container">
        <!--https://api.jqueryui.com/tabs/#entry-examples-->
        <div class="row">
            <ul class="nav nav-tabs">
                <li><a href="@routes.AdminController.index">Overview</a></li>
                <li><a href="@routes.AdminController.analytics">Analytics</a></li>
                <li><a href="@routes.AdminController.contributions">Contributions</a></li>
                <li><a href="@routes.AdminController.comments">Comments</a></li>
                <li class="active"><a href="@routes.AdminController.users">Users</a></li>


            </ul>
        </div>

        <div class="row">
            <h1>Users</h1>
            <div class="col-lg-12">
                <table id="userTable" class="table table-striped table-condensed">
                <thead>
                    <tr>
                        <th class="col-md-1">Username</th>
                        <th class="col-md-2">User Id</th>
                        <th class="col-md-2">Email</th>
                        <th class="col-md-2">Date Registered</th>
                        <th class="col-md-2">Last Login</th>
                        <th class="col-md-1">Login Count</th>
                        <th class="col-md-1">Mission Count</th>
                        <th class="col-md-1">Audit Count</th>
                        <th class="col-md-1">Label Count</th>
                    </tr>
                    </thead>
                    <tbody>
                    @UserDAOImpl.all.map { u =>
                        <tr>
                            <td><a href='@routes.AdminController.userProfile(u.username)'>@u.username</a></td>
                            <td>@u.userId</td>
                            <td>@u.email</td>
                            <td>@WebpageActivityTable.selectSignUpTimestamp(UUID.fromString(u.userId))</td>
                            <td>@WebpageActivityTable.selectLastSignInTimestamp(UUID.fromString(u.userId))</td>
                            <td>@WebpageActivityTable.selectSignInCount(UUID.fromString(u.userId))</td>
                            <td>@MissionTable.countCompletedMissionsByUserId(UUID.fromString(u.userId))</td>
                            <td>@AuditTaskTable.countCompletedAuditsByUserId(UUID.fromString(u.userId))</td>
                            <td>@LabelTable.countLabelsByUserId(UUID.fromString(u.userId))</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        </div>

        <div class="row">
            <h1>Anonymous Users</h1>
            <div class="col-lg-12">
                <table id="anonUserTable" data-order='[[ 1, "desc" ]]' class="table table-striped table-condensed">
                    <thead>
                        <tr>
                            <th class="col-md-6">IP Address</th>
                            <th class="col-md-3">Audit Count</th>
                            <th class="col-md-3">Label Count</th>
                        </tr>
                    </thead>
                    <tbody>
                    @UserDAOImpl.getAnonymousUserProfiles.map { anon =>
                        <tr>
                            <td>@anon.ipAddress</td>
                            <td>@anon.auditCount</td>
                            <td>@anon.labelCount</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        </div>

    </div>
    <link href='@routes.Assets.at("stylesheets/c3.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/admin.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/bootstrap.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/dataTables.bootstrap.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/ekko-lightbox.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/ekko-lightbox.min.css")' rel="stylesheet"/>

    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/moment.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/d3.v3.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/c3.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/Admin/build/Admin.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/turf.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/jquery.dataTables.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/dataTables.bootstrap.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/Utilities.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/UtilitiesSidewalk.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVLabel/src/SVLabel/util/UtilitiesColor.js")'></script>
    <script>
        $(document).ready(function () {
            window.admin = Admin (_, $, c3, turf);
            $('#commentsTable').dataTable();
            $('#labelTable').dataTable();
            $('#userTable').dataTable();
            $('#anonUserTable').dataTable();

        });
    </script>
}